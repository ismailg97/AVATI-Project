@page "/skill"
@page "/skill/index"

@using Team12.Data
@using DocumentFormat.OpenXml.Wordprocessing
@inject ISkillService _skillService
@inject DatabaseUtils _database

@{ _database.CreateTable();}

<h4>Eine Übersicht über alle Skills</h4>

<table class ="table table-striped">
    <thead class="thead-light">
    <tr>
        <th scope="col">ID</th>
        <th scope="col">Skillname</th>
        <th scope="col">Skilltyp</th>
        <th scope="col">Bearbeiten</th>
        <th scope="col">Löschen</th>
        <th scope="col">Hinzufügen</th>
    </tr>
    </thead>
    <tbody>
    @if (_skillService.GetAllSkills().Any())
    {
        @foreach (var skill in _skillService.GetAllSkills())
        {
            <tr>
                <td>@skill.Id</td>
                <td>@skill.Name</td>
                <td>@skill.SkillType</td>
                <td><a class="btn btn-secondary" href="/skill/edit/@skill.Id" role="button">Bearbeiten</a></td>
                <td><a class="btn btn-danger" @onclick="@(() => _skillService.DeleteSkill(skill.Id))" role="button">Löschen</a></td>
                <td><a class="btn btn-success" href="/skill/edit" role="button">Hinzufügen</a></td>
            </tr>
        }   
    }
    else
    {
        LoadDatabaseJson();
    }
    </tbody>
    
</table>

@code {
    private DatabaseJson databaseJson { get; set;  }= new DatabaseJson();

    public void LoadDatabaseJson()
    {
        foreach (var skill in databaseJson.LoadJson())
        {
            _skillService.UpdateSkill(new Skill() {Id = 0, Name = skill, SkillType = Skill.Category.Hardskill});
        }
    }
}